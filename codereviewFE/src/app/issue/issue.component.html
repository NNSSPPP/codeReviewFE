<div class="container my-4">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2><i class="bi bi-list-task me-2"></i> Issues Management</h2>
    
    <!-- ปุ่ม My Assignment ฝั่งขวา -->
    <a [routerLink]="['/assignment']" class="custom-btn" title="My Assignment">
      <i class="bi bi-person-badge me-1"></i> My Assignment
    </a>
    
  </div>

  <!-- Filters & Search -->
  <div class="d-flex flex-wrap gap-2 mb-4 align-items-center">
    <select class="form-select w-auto" [(ngModel)]="filterType">
      <option>All Types</option>
      <option value="bug">Bug</option>
      <option value="security">Security</option>
      <option value="code-smell">Code Smell</option>
    </select>

    <select class="form-select w-auto" [(ngModel)]="filterSeverity">
      <option>All Severity</option>
      <option value="critical">Critical</option>
      <option value="high">High</option>
      <option value="medium">Medium</option>
      <option value="low">Low</option>
    </select>

    <select class="form-select w-auto" [(ngModel)]="filterStatus">
      <option>All Status</option>
      <option value="open">Open</option>
      <option value="in-progress">In Progress</option>
      <option value="resolved">Resolved</option>
    </select>

    <select class="form-select w-auto" [(ngModel)]="filterProject">
      <option>All Projects</option>
      <option>API-Service</option>
      <option>Angular-App</option>
      <option>Web-Portal</option>
      <option>Auth-Service</option>
    </select>

    <input class="form-control w-auto" type="text" placeholder="Search issues..." [(ngModel)]="searchText">
    <button class="btn btn-outline-primary" (click)="clearFilters()">Clear</button>
  </div>

  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered align-middle">
      <thead class="table-light">
        <tr>
          <th class="text-center"><input type="checkbox" [(ngModel)]="selectAllCheckbox" (change)="selectAll($event)"></th>
          <th>Type</th>
          <th>Severity</th>
          <th>Issue</th>
          <th>Project</th>
          <th>Assigned</th>
          <th>Status</th>
          <th class="text-center">View</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let issue of paginatedIssues">
          <td class="text-center"><input type="checkbox" [(ngModel)]="issue.selected"></td>
          <td><i class="bi me-1" [ngClass]="typeIcon(issue.type)"></i>{{ issue.type | titlecase }}</td>
          <td [ngClass]="severityClass(issue.severity)">{{ issue.severity | titlecase }}</td>
          <td>
            <strong>{{ issue.title }}</strong><br>
            <small class="text-muted">{{ issue.details }}</small>
          </td>
          <td>{{ issue.project }}</td>
          <td>{{ issue.assignee }}</td>
          <td [ngClass]="statusClass(issue.status)">{{ issue.status | titlecase }}</td>
          <td class="text-center">
            <a [routerLink]="['/issuedetail', issue.id_issue]" class="btn btn-info btn-sm">
              <i class="bi bi-eye"></i>
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

   <!-- Footer -->
<div class="d-flex flex-column flex-md-row justify-content-between align-items-center my-3 gap-2">
  <div><strong>Selected:</strong> {{ selectedCount() }}</div>

  <div class="d-flex align-items-center gap-1">
    <button class="btn btn-outline-primary btn-sm px-3 py-2 btn-big" (click)="prevPage()">
      <i class="bi bi-chevron-left"></i>
    </button>
    <span class="mx-1">Page {{ currentPage }}</span>
    <button class="btn btn-outline-primary btn-sm px-3 py-2 btn-big" (click)="nextPage()">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>

  <div class="d-flex gap-1 flex-wrap">
    <button class="btn btn-primary btn-sm px-3 py-2 btn-big" (click)="assignDeveloper()" title="Assign Developer">
      <i class="bi bi-person-plus me-1"></i>
    </button>
    <button class="btn btn-secondary btn-sm px-3 py-2 btn-big" (click)="changeStatus()" title="Change Status">
      <i class="bi bi-arrow-repeat me-1"></i>
    </button>
    <button class="btn btn-success btn-sm px-3 py-2 btn-big" (click)="exportData()" title="Export">
      <i class="bi bi-download me-1"></i>
    </button>
  </div>
</div>
</div>