<div class="issue-container">
  <!-- Header -->
  <div class="issue-header">
    <button class="back-btn" (click)="goBack()"><i class="bi bi-arrow-left"></i></button>
    <h2><i class="bi bi-shield-lock-fill"></i> {{ issue.type }} issue : {{ issue.title }}</h2>
    <span class="severity" [ngClass]="issue.severity.toLowerCase()">{{ issue.severity }}</span>
  </div>

  <!-- Issue Info -->
  <div class="issue-info">
    <div><strong>ID:</strong> {{ issue.id }}</div>
    <div><strong>Status:</strong> {{ issue.status }}</div>
    <div><strong>Assigned:</strong> {{ issue.assignedTo }}</div>
    <div><strong>Project:</strong> {{ issue.project }}</div>
    <div><strong>File:</strong> {{ issue.file }} (Line {{ issue.line }})</div>
    <div><strong>Created:</strong> {{ issue.created | date:'short' }}</div>
    <div><strong>Due Date:</strong> {{ issue.dueDate | date:'short' }}</div>
  </div>

  <!-- Description -->
  <div class="issue-description">
    <h3>Description</h3>
    <p>{{ issue.description }}</p>
    <pre class="code-block">{{ issue.vulnerableCode }}</pre>
    <p><strong>Recommended Fix:</strong> {{ issue.recommendedFix }}</p>
  </div>

  <!-- Comments -->
  <div class="issue-comments">
    <h3>Comments & Discussion</h3>
    <div class="comment" *ngFor="let c of issue.comments">
      <p><strong>{{ c.userId }}</strong> - {{ c.timestamp | date:'short' }}</p>
      <p>{{ c.comment }}</p>
      <div *ngIf="c.attachments?.length">
        <ul>
          <li *ngFor="let a of c.attachments">
            <a [href]="a.url" target="_blank">ðŸ“Ž {{ a.filename }}</a>
          </li>
        </ul>
      </div>
    </div>

    <div class="add-comment d-flex align-items-center gap-2 mt-3">
      <!-- Mention Input à¸¢à¸±à¸‡à¸—à¸³à¹„à¸¡à¹ˆà¹„à¸”à¹‰-->
      <input
        type="text"
        placeholder="@username..."
        [(ngModel)]="newComment.mention"
        class="form-control"
        title="Mention someone"
      />
    
      <!-- Comment Input -->
      <input
        type="text"
        placeholder="Write a comment..."
        [(ngModel)]="newComment.comment"
        class="form-control flex-grow-1"
        title="Write your comment"
      />
    
      <!-- Post Button -->
      <button class="btn btn-primary" (click)="postComment()">
        <i class="bi bi-chat-dots"></i> 
      </button>
    </div>
    

  <!-- Action Buttons -->
  <div class="action-icons">

    <!--à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ-->
    <button (click)="changeAssignee('@newAssignee')" title="Change Assignee"><i class="bi bi-person"></i></button>
    
    <button (click)="updateStatus()" title="Update Status"><i class="bi bi-arrow-repeat"></i></button>
    <button (click)="setPriority()" title="Set Priority"><i class="bi bi-lightning"></i></button>
    <button (click)="closeIssue()" title="Close Issue"><i class="bi bi-check"></i></button>
  </div>
</div>
