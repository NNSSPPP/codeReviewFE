<div class="issue-container">
  <!-- Header -->
  <div class="issue-header">
    <button class="back-btn" (click)="goBack()"><i class="bi bi-arrow-left"></i></button>
    <h2><i class="bi bi-shield-lock-fill"></i> {{ issue.type }} issue : {{ issue.title }}</h2>
    <span class="priority" [ngClass]="issue.priority?.toLowerCase() || 'No priority'">
      {{ issue.priority || 'No priority' }}
    </span>
  </div>

 <!-- Issue Info -->
<div class="issue-info">
  <div class="info-row">
    <div><strong>ID:</strong> {{ issue.id }}</div>
    <div><strong>Type:</strong> {{ issue.type }}</div>
  </div>
  <div class="info-row">
    <div><strong>Severity:</strong> <span class="badge severity {{ issue.severity.toLowerCase() }}">{{ issue.severity }}</span></div>
    <div><strong>Status:</strong> <span class="badge status {{ issue.status.toLowerCase() }}">{{ issue.status }}</span></div>
  </div>
  <div class="info-row">
    <div><strong>Project:</strong> {{ issue.project }}</div>
    <div><strong>File:</strong> {{ issue.file }}</div>
  </div>
  <div class="info-row">
    <div><strong>Line:</strong> {{ issue.line }}</div>
    <div><strong>Created:</strong> {{ issue.created | date:'dd/MM/yyyy, hh:mm a' }}</div>
  </div>
  <div class="info-row">
    <div><strong>Assigned:</strong> {{ issue.assignedTo?.length ? issue.assignedTo.join(', ') : issue.assignedTo || 'No assignee' }}</div>
    <div><strong>Due Date:</strong> {{ issue.dueDate | date:'dd/MM/yyyy, hh:mm a' }}</div>
  </div>
</div>


  <!-- Description -->
  <div class="issue-description">
    <h3>Description</h3>
    <p>{{ issue.description }}</p>
    <pre class="code-block">{{ issue.vulnerableCode }}</pre>
    <p><strong>Recommended Fix:</strong> {{ issue.recommendedFix }}</p>
  </div>

  <!-- Comments -->
  <div class="issue-comments">
    <h3>Comments & Discussion</h3>
    <div class="comment" *ngFor="let c of issue.comments">
      <p><strong>{{ c.userId }}</strong> - {{ c.timestamp | date:'dd/MM/yyyy, hh:mm a' }}</p>
      <p>{{ c.comment }}</p>
      <div *ngIf="c.attachments?.length">
        <ul>
          <li *ngFor="let a of c.attachments">
            <a [href]="a.url" target="_blank">ðŸ“Ž {{ a.filename }}</a>
          </li>
        </ul>
      </div>
    </div>

    <div class="add-comment d-flex align-items-center gap-2 mt-3">
    
      <!-- Comment Input -->
      <input
        type="text"
        placeholder="Write a comment..."
        [(ngModel)]="newComment.comment"
        class="form-control flex-grow-1"
        title="Write your comment"
      />
    
      <!-- Post Button -->
      <button class="btn btn-primary" (click)="postComment()">
        <i class="bi bi-chat-dots"></i> 
      </button>
    </div>
    

  <!-- Action Buttons -->
  <div class="action-icons">

    <!--à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ-->
    <button (click)="changeAssignee()" title="Change Assignee" class="btn btn-primary">
      <i class="bi bi-person"></i>
    </button>
    
    <button (click)="setPriority()" title="Set Priority"><i class="bi bi-lightning"></i></button>
    <button (click)="updateStatus()" title="Update Status"><i class="bi bi-arrow-repeat"></i></button>
    <button (click)="closeIssue()" title="Close Issue"><i class="bi bi-check"></i></button>
  </div>
</div>
