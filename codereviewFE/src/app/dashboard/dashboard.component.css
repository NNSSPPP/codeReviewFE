/* ===============================
   BASE (โครงสร้างพื้นฐาน)
   =============================== */
   .dashboard-container, 
   .main-content {
     overflow: visible !important; /* กัน scroll หาย */
   }
   
   .dashboard-container {
     color: var(--text-main);
     font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans";
     padding: 20px;
   }
   
   
   /* ===============================
      HEADER (ส่วนหัว Dashboard)
      =============================== */
   .dashboard-header {
     display: flex;
     justify-content: space-between;
     align-items: center;
     flex-wrap: wrap;
     background: linear-gradient(180deg, var(--bg-card) 0%, var(--bg-panel) 100%);
     border: 1px solid var(--card-border);
     border-radius: 14px;
     box-shadow: 0 10px 30px var(--card-shadow);
     padding: 10px 18px;
     margin-bottom: 16px;
   }
   
   .dashboard-title { 
    display: flex;                
    align-items: center;          
    gap: 10px;                    
    font-size: 24px; 
    font-weight: 800; 
    color: var(--dashboard-title-color) !important;
  }
  
   
   
   
   .dashboard-actions { display: flex; align-items: center; gap: 10px; }
   .header-left, .header-right { display: flex; align-items: center; gap: 10px; }
   .admin-name { font-size: 12px; color: var(--text-muted); }
   
   
   /* ===============================
      ACTION BUTTONS (ปุ่มใน Header)
      =============================== */
   .dashboard-actions .btn-link {
     background: transparent;
     border: none;
     border-radius: 10px;
     color: var(--text-muted);
     font-size: 12px;
     padding: 0 4px;
     transition: color .2s, background .2s, transform .06s;
   }
   
   .dashboard-actions .btn-link:hover {
     background: var(--navbar-hover);
     color: var(--btn-primary-bg);
     transform: translateY(-1px);
   }
      
   
   /* ===============================
      EXPORT BUTTON (ปุ่ม Export)
      =============================== */
   .export-btn {
     position: relative;
     display: inline-flex;
     align-items: center;
     justify-content: center;
     gap: 8px;
     width: 50px; height: 50px;
     font-size: 16px;
     font-weight: 500;
     background: var(--btn-primary-bg);
     color: var(--btn-primary-text);
     border: none;
     border-radius: 8px;
     cursor: pointer;
     transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
   }
   
   .export-btn i { font-size: 20px; }
   
   .export-btn:hover {
     background: var(--btn-primary-bg-hover);
     transform: translateY(-2px);
     box-shadow: 0 6px 15px rgba(0,0,0,0.15);
   }
   
   .export-btn:active { transform: scale(0.96); }
   
   
   /* ===============================
      NOTIFICATIONS (แจ้งเตือน)
      =============================== */
   .notification-wrapper {
     position: relative;
     display: inline-flex;
     align-items: center;
     justify-content: center;
     width: 50px; height: 50px;
     background: var(--notification-bg);
     border-radius: 50%;
     cursor: pointer;
     transition: transform .2s, box-shadow .2s;
     z-index: 1000;
     border: none;
     outline: none;
   }
   .notification-wrapper:hover {
     transform: scale(1.1);
     box-shadow: 0 6px 15px rgba(0,0,0,0.15);
   }
   .notification-icon { font-size: 18px; color: var(--notification-icon); }
   .notification-badge {
     position: absolute;
     top: -4px; right: -4px;
     background: var(--notification-badge);
     color: #fff;
     font-size: 11px;
     font-weight: 700;
     padding: 2px 6px;
     border-radius: 50%;
     box-shadow: 0 0 0 2px var(--bg-card);
   }
   
   /* Panel รายการแจ้งเตือน */
   .notifications-panel {
     position: absolute;
     top: 100%; right: 0;
     width: 300px; max-height: 80vh;
     background: var(--notification-panel-bg);
     border-radius: 14px;
     box-shadow: 0 10px 30px var(--card-shadow);
     overflow-y: auto;
     padding: 12px;
     z-index: 9999;
   }
   
   .notifications-panel * { white-space: normal; word-break: break-word; }
   .notifications-header {
     display: flex; justify-content: space-between; align-items: center;
     font-weight: 700; margin-bottom: 10px; color: var(--text-main);
   }
   .notifications-header .close-btn { background: transparent; border: none; font-size: 16px; cursor: pointer; }
   
   .notification-tabs {
     display: flex; flex-wrap: wrap; gap: 6px;
     margin-bottom: 10px; justify-content: space-between;
   }
   .notification-tabs button {
     flex: 1 1 auto;
     min-width: 80px; 
     padding: 4px 8px;
     font-size: 11px; 
     border-radius: 6px;
     border: 1px solid var(--card-border);
     background: var(--bg-panel);
     color: var(--text-main);
     cursor: pointer; 
     transition: 0.2s;
   }
   .notification-tabs button:hover {
     background: var(--notification-bg); 
     border-color: var(--btn-primary-bg); 
     color: var(--btn-primary-bg);
   }
   
   /* Notification item */
   .notification-item {
     border-radius: 8px;
     padding: 8px 10px;
     margin-bottom: 8px;
     background: var(--notification-bg);
     transition: 0.2s;
   }
   .notification-item:hover { background: var(--btn-primary-bg); color: #fff; }
   
   .item-header { display: flex; justify-content: space-between; font-size: 12px; font-weight: 700; }
   .item-message { font-size: 13px; margin: 4px 0; }
   .view-link {
     font-size: 11px; background: transparent;
     border: none; color: var(--btn-primary-bg); cursor: pointer;
   }
   .view-link:hover { text-decoration: underline; }
   .load-more {
     width: 100%; padding: 6px 0;
     border: none; border-radius: 6px;
     background: var(--btn-primary-bg); color: var(--btn-primary-text);
     cursor: pointer; font-size: 12px; font-weight: 600;
   }
   .load-more:hover { background: var(--btn-primary-bg-hover); }
   
   
   /* ===============================
      STATUS CARDS (การ์ดสถานะ)
      =============================== */
   .status-cards { display: flex; gap: 12px; margin: 16px 0 20px; }
   
   .card {
     flex: 1;
     padding: 16px;
     text-align: center;
     font-weight: 800;
     border-radius: 12px;
     border: 1px solid var(--card-border);
     background: var(--bg-card);
     box-shadow: 0 6px 18px var(--card-shadow);
     position: relative;
     transition: box-shadow 0.22s cubic-bezier(.2,.8,.2,1), transform 0.22s cubic-bezier(.2,.8,.2,1);
   }
   .card::before {
     content: "";
     position: absolute; top: 0; left: 0; bottom: 0;
     width: 6px; border-radius: 12px 0 0 12px;
   }
   .card.passed::before  { background: linear-gradient(180deg,var(--status-passed-bg),var(--status-passed-text)); }
   .card.warning::before { background: linear-gradient(180deg,var(--status-warning-bg),var(--status-warning-text)); }
   .card.failed::before  { background: linear-gradient(180deg,var(--status-failed-bg),var(--status-failed-text)); }
   
   
   /* ===============================
      RECENT SCANS TABLE (ตาราง)
      =============================== */
   .recent-scans { animation: fadeIn .8s ease-in-out; margin-bottom: 20px; }
   .recent-scans table {
     width: 100%;
     border-collapse: separate; border-spacing: 0;
     border-radius: 12px; overflow: hidden;
     border: 1px solid var(--card-border);
     background: var(--bg-card);
     box-shadow: 0 6px 18px var(--card-shadow);
     text-align: center;
   }
   .recent-scans thead th {
     font-size: 12px; font-weight: 700; text-transform: uppercase;
     padding: 12px 14px;
     background: linear-gradient(180deg,var(--table-header-bg),var(--table-header-bg2));
     color: var(--table-header-text); text-align: center; vertical-align: middle;
   }
   .recent-scans td {
     font-size: 13px; padding: 12px 14px;
     border-top: 1px solid var(--table-border);
     text-align: center; vertical-align: middle;
   }
   .recent-scans td button {
     display: inline-flex; align-items: center; justify-content: center;
     padding: 6px 12px; font-size: 12px;
     color: #000;
     border-radius: 10px; border: 1px solid var(--btn-primary-bg-hover);
     background: linear-gradient(180deg,var(--btn-primary-bg),var(--btn-primary-bg-hover));
   }
   .recent-scans td button i.bi { margin-right: 4px; color: inherit; }
   .recent-scans td button:hover {
     transform: translateY(-1px);
     box-shadow: 0 10px 16px rgba(37, 99, 235, 0.22);
   }
   
   
   /* ===============================
      STATUS / GRADE COLORS
      =============================== */
   .status-cell, .grade-cell {
     text-align: center; font-weight: 700;
     vertical-align: middle; padding: 12px 0;
     cursor: default; transition: transform .25s ease;
   }
   .status--passed  { background: var(--status-passed-bg); color: var(--status-passed-text); }
   .status--warning { background: var(--status-warning-bg); color: var(--status-warning-text); }
   .status--failed  { background: var(--status-failed-bg); color: var(--status-failed-text); }
   
   .grade--a { background: var(--grade-a); color:#fff; }
   .grade--b { background: var(--grade-b); color:#fff; }
   .grade--c { background: var(--grade-c); color:#fff; }
   .grade--d { background: var(--grade-d); color:#fff; }
   .grade--e { background: var(--grade-e); color:#fff; }
   
   
   /* ===============================
      METRICS (การ์ดสถิติ)
      =============================== */
   .metrics { display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; }
   
   .metric-card {
     flex: 1; padding: 18px;
     border-radius: 12px; border: 1px solid var(--card-border);
     background: var(--bg-card);
     box-shadow: 0 6px 18px var(--card-shadow);
     text-align: center;
     transition: transform 0.2s ease, box-shadow 0.2s ease;
   }
   .metric-card:hover {
     transform: translateY(-2px);
     box-shadow: 0 12px 22px rgba(17, 24, 39, 0.12), 0 2px 6px rgba(0,0,0,0.04);
   }
   .metric-icon { font-size: 28px; margin-bottom: 8px; }
   
   .metrics .metric-card.bugs .metric-icon { color: var(--metric-bugs); }
   .metrics .metric-card.security .metric-icon { color: var(--metric-security); }
   .metrics .metric-card.code-smells .metric-icon { color: var(--metric-code-smells); }
   .metrics .metric-card.coverage .metric-icon { color: var(--metric-coverage); }
   
   .metric-title { font-size: 14px; font-weight: 600; color: var(--text-muted); }
   .metric-value { font-size: 24px; font-weight: 800; margin: 6px 0; color: var(--text-main); }
   .metric-change { font-size: 12px; font-weight: 700; }
   .metric-change.increase { color: var(--metric-coverage); }
   .metric-change.decrease { color: var(--btn-logout-text); }
   
   
   /* ===============================
      QUALITY TREND
      =============================== */
   .quality-trend {
     padding: 18px; margin-bottom: 20px;
     border-radius: 12px; border: 1px solid var(--card-border);
     background: var(--bg-card);
     box-shadow: 0 10px 30px var(--card-shadow);
   }
   .chart-placeholder {
     height: 170px; display: grid; place-items: center;
     font-weight: 700;
     border-radius: 12px; border: 2px dashed var(--btn-primary-bg-hover);
     background: linear-gradient(180deg,var(--bg-panel),var(--notification-bg));
   }
   
   
   /* ===============================
      BOTTOM SECTION
      =============================== */
   .bottom-section { display: flex; gap: 16px; }
   .issues, .distribution {
     flex: 1; padding: 16px;
     border-radius: 12px; border: 1px solid var(--card-border);
     background: var(--bg-card);
     box-shadow: 0 6px 18px var(--card-shadow);
   }
   .bottom-section h3 { font-size: 16px; font-weight: 800; margin-bottom: 10px; }
   
   
   /* ===============================
      TOP SECTION
      =============================== */
   .row.top-section { display: flex; gap: 20px; margin-bottom: 20px; align-items: flex-start; }
   .quality-gate-card, .recent-scans {
     background: var(--bg-card); padding: 15px;
     border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);
     flex: 1; overflow-x: auto; 
   }
   
   
   /* ===============================
      VIEW ALL LINK
      =============================== */
   .button-container { display: flex; justify-content: flex-end; margin-top: 12px; }
   .view-all-link {
     font-size: 16px; font-weight: 700;
     color: var(--btn-primary-bg); text-decoration: none;
     display: inline-flex; align-items: center; gap: 6px;
     transition: color 0.2s, transform 0.2s;
   }
   .view-all-link:hover { color: var(--btn-primary-bg-hover); transform: translateX(2px); }
   .view-all { text-align: right; margin-top: 8px; }
   .view-all a { color: var(--btn-primary-bg); font-weight: 600; text-decoration: none; transition: color .25s ease, transform .2s ease; }
   .view-all a:hover { text-decoration: underline; transform: translateY(-1px); }
   
   
   /* ===============================
      PROGRESS BAR
      =============================== */
   progress.progress-bar {
     width: 100%; height: 20px;
     border-radius: 8px; appearance: none;
   }
   progress.progress-bar::-webkit-progress-bar { background-color: var(--progress-bg); border-radius: 8px; }
   progress.progress-bar::-webkit-progress-value { background-color: var(--progress-value); border-radius: 8px; }
   progress.progress-bar.bg-success::-webkit-progress-value { background-color: var(--progress-success); }
   progress.progress-bar.bg-primary::-webkit-progress-value { background-color: var(--progress-primary); }
   progress.progress-bar::-moz-progress-bar { background-color: var(--progress-value); border-radius: 8px; }
   
   
   /* ===============================
      RESPONSIVE
      =============================== */
   @media (max-width: 1024px) { .status-cards { flex-direction: column; } .metrics { flex-wrap: wrap; } }
   @media (max-width: 768px) { .dashboard-header { flex-wrap: wrap; gap: 8px; } .bottom-section, .row.top-section { flex-direction: column; } .recent-scans table { display: block; overflow-x: auto; } }
   @media (max-width: 767px) {
     .dashboard-header { flex-wrap: wrap; gap: 8px; }
     .dashboard-actions { display: flex; justify-content: flex-end; width: 100%; }
     .notification-wrapper { position: relative; z-index: 1000; }
     .notifications-panel {
       position: absolute; top: 100%; right: 5px; left: auto;
       width: 280px; max-width: 90vw; max-height: 90vh;
       margin: 0; box-sizing: border-box !important; overflow-y: auto;
     }
   }
   
   
   /* ===============================
      ANIMATIONS
      =============================== */
   @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
   @keyframes fadeIn { 0%{opacity:0;} 100%{opacity:1;} }
   @keyframes slideUp { 0%{transform:translateY(10px);opacity:0;} 100%{transform:translateY(0);opacity:1;} }
   .chart text {
    fill: var(--text-main) !important;
    color: var(--text-main) !important;
  }


/* Dark mode */
.dark-mode .notification-tabs button {
  color: var(--text-main);   /* ✅ จะดึงสีขาวจาก --text-main */
}
/* ===============================
   Mobile Responsive (≤576px)
   =============================== */
   @media (max-width: 576px) {
    /* ลดความสูง header ทั้งแถบ */
    .dashboard-header {
      padding: 6px 10px;   /* จาก 10px 18px → เล็กลง */
      gap: 6px;
    }
  
    .dashboard-title {
      font-size: 16px; /* จาก 18px → เล็กลง */
    }
  
    .admin-name {
      font-size: 11px; /* ตัว Admin เล็กลง */
    }
  
    /* ปุ่ม Export + Notification */
    .export-btn,
    .notification-wrapper {
      width: 38px;
      height: 38px;
      border-radius: 8px;
    }
  
    .export-btn i,
    .notification-icon {
      font-size: 15px;
    }
  
    /* Badge (เลขแจ้งเตือน) */
    .notification-badge {
      font-size: 10px;
      padding: 1px 4px;
      top: -2px;
      right: -2px;
    }
  }
  
  
/* ===============================
   Sticky Action Column — Seamless + Header Color Match (FINAL)
   =============================== */

/* ===== 1. Table base ===== */
.recent-scans table {
  width: 100%;
  border-collapse: separate !important;
  border-spacing: 0;
  position: relative;
  overflow: visible;
  background: var(--bg-card);
  border: none !important;
  box-shadow: none !important;
}

/* ล้างขอบทั้งหมดก่อนเริ่มใหม่ */
.recent-scans table th,
.recent-scans table td {
  border: none !important;
  box-shadow: none !important;
}

/* ===== 2. Normal rows ===== */
.recent-scans td {
  border-bottom: 1px solid var(--table-border);
}

/* ===== 3. Sticky Action column (cells) ===== */
.recent-scans table td:last-child,
.recent-scans table th:last-child {
  position: sticky;
  right: 0;
  z-index: 5;
  background: var(--bg-card);
  border-left: none !important;
  border-right: none !important;
  box-shadow: none !important;
}

/* เพิ่มพื้นหลังต่อเนื่องเพื่อไม่ให้เห็นขอบ */
.recent-scans table td:last-child::after,
.recent-scans table th:last-child::after {
  content: "";
  position: absolute;
  inset: 0;
  background: var(--bg-card);
  z-index: -1;
}

/* ===== 4. ลบเส้นคั่นจากคอลัมน์ TIME (ก่อนหน้า ACTION) ===== */
.recent-scans table th:nth-last-child(2),
.recent-scans table td:nth-last-child(2) {
  border-right: none !important;
  box-shadow: none !important;
}

/* ===== 5. Match header background (TIME = ACTION) ===== */
.recent-scans table thead th {
  background: linear-gradient(180deg, var(--table-header-bg), var(--table-header-bg2));
  color: var(--table-header-text);
}

.recent-scans table thead th:last-child {
  background: linear-gradient(180deg, var(--table-header-bg), var(--table-header-bg2)) !important;
  color: var(--table-header-text) !important;
  border: none !important;
  box-shadow: none !important;
  backdrop-filter: blur(3px);
}

/* ===== 6. Buttons inside ACTION column ===== */
.recent-scans table td:last-child button {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  border: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  transition: all 0.25s ease;
}

/* ปุ่มฟ้า (View) */
.recent-scans table td:last-child button.btn-primary {
  background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
  box-shadow: 0 4px 10px rgba(37,99,235,0.25);
}
.recent-scans table td:last-child button.btn-primary:hover {
  transform: translateY(-2px);
  background: linear-gradient(180deg, #2563eb 0%, #1d4ed8 100%);
  box-shadow: 0 6px 18px rgba(37,99,235,0.35);
}

/* ปุ่มส้ม (Retry) */
.recent-scans table td:last-child button.btn-warning {
  background: linear-gradient(180deg, #f59e0b 0%, #d97706 100%);
  box-shadow: 0 4px 10px rgba(217,119,6,0.25);
}
.recent-scans table td:last-child button.btn-warning:hover {
  transform: translateY(-2px);
  background: linear-gradient(180deg, #d97706 0%, #b45309 100%);
  box-shadow: 0 6px 18px rgba(180,83,9,0.35);
}

/* Icon ขนาด */
.recent-scans table td:last-child i {
  font-size: 18px;
}

/* ===== 7. Dark mode fix ===== */
.dark-mode .recent-scans table td:last-child,
.dark-mode .recent-scans table th:last-child {
  background: var(--bg-panel);
}
.dark-mode .recent-scans table td:last-child::after,
.dark-mode .recent-scans table th:last-child::after {
  background: var(--bg-panel);
}
.dark-mode .recent-scans table thead th:last-child {
  background: linear-gradient(180deg, var(--table-header-bg), var(--table-header-bg2)) !important;
}
/* ===============================
   FIX: Match ACTION header background color
   =============================== */

/* กำหนดสี background ของหัวคอลัมน์ Action ให้เหมือนหัวอื่น */
.recent-scans table thead th:last-child {
  background: linear-gradient(180deg, var(--table-header-bg), var(--table-header-bg2)) !important;
  color: var(--table-header-text) !important;
  border-left: none !important;
  border-right: none !important;
  box-shadow: none !important;
}

/* ลบเงาจาง ๆ ที่ทำให้ดูขาวกว่า */
.recent-scans table thead th:last-child::after {
  content: none !important;
}

/* ให้คอลัมน์ Action sticky แต่ยังใช้สีหัวตารางเดิม */
.recent-scans table th:last-child {
  position: sticky;
  right: 0;
  z-index: 5;
  background: linear-gradient(180deg, var(--table-header-bg), var(--table-header-bg2)) !important;
}


/* ===============================
   FIX — Sticky Action Column (Header unchanged, opaque)
   =============================== */

   .recent-scans {
    position: relative;
  }
  
  .table-wrapper {
    position: relative;
    overflow-x: auto;
    overflow-y: visible;
  }
  
  /* Sticky Action column */
  .table-wrapper table td:last-child {
    position: sticky;
    right: 0;
    z-index: 10;
    background: #fff;
    border-left: 1px solid #e5e7eb;
    box-shadow: -1px 0 0 #e5e7eb;
  }
  
  /* Sticky header (ใช้สีเดิมของหัวตาราง) */
  .table-wrapper table thead th:last-child {
    position: sticky;
    right: 0;
    z-index: 11;
    background: linear-gradient(180deg, var(--table-header-bg), var(--table-header-bg2));
  }
  
  /* ✅ Overlay บังแนวขวาทั้งหมด */
  .sticky-cover {
    position: sticky;
    right: 0;
    top: 0;
    width: 120px;             /* ปรับให้เท่าคอลัมน์ ACTION */
    height: 100%;
    background: #fff;         /* ปิดทึบสนิท */
    z-index: 9;
    pointer-events: none;     /* ไม่บังปุ่ม */
    border-left: 1px solid #e5e7eb;
  }
  
  /* ปุ่ม Action */
  .table-wrapper table td:last-child button {
    width: 44px;
    height: 44px;
    border-radius: 12px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    border: none;
    transition: transform 0.25s ease;
  }
  
  /* ปุ่มฟ้า */
  .table-wrapper table td:last-child button.btn-primary {
    background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
    box-shadow: 0 4px 10px rgba(37,99,235,0.25);
  }
  .table-wrapper table td:last-child button.btn-primary:hover {
    transform: translateY(-2px);
  }
  
  /* ปุ่มส้ม */
  .table-wrapper table td:last-child button.btn-warning {
    background: linear-gradient(180deg, #f59e0b 0%, #d97706 100%);
    box-shadow: 0 4px 10px rgba(217,119,6,0.25);
  }
  .table-wrapper table td:last-child button.btn-warning:hover {
    transform: translateY(-2px);
  }
  
  /* Dark Mode */
  :host-context(body.dark-mode) .table-wrapper table td:last-child {
    background: #1e1e1e;
    border-left: 1px solid #333;
  }
  :host-context(body.dark-mode) .sticky-cover {
    background: #1e1e1e;
    border-left: 1px solid #333;
  }
  